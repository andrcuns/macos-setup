# =====================================================================================================================
# General zsh settings
# =====================================================================================================================

# Disable control flow (ctrl-s / ctrl-q)
stty stop '' -ixoff -ixon

# Set spelling correction
setopt correct

# Dont raise errors when regex nomatch fires
unsetopt nomatch

# =====================================================================================================================
# Oh my zsh settings
# =====================================================================================================================
# Path to your oh-my-zsh installation.
export ZSH={{ user.home }}/.oh-my-zsh

# Theme declaration
ZSH_THEME="pure"

# Disable marking repo as dirty due to untracked files
DISABLE_UNTRACKED_FILES_DIRTY="true"

# Plugin declaration
plugins=(git adb osx brew colorize cp docker zsh-syntax-highlighting zsh-autosuggestions zsh-completions mvn gradle)

# =====================================================================================================================
# Sourcing
# =====================================================================================================================
# Oh-my-zsh
source $ZSH/oh-my-zsh.sh
source $ZSH/custom/plugins/zsh-history-substring-search/zsh-history-substring-search.zsh

# =====================================================================================================================
# Plugin bindings
# =====================================================================================================================

# History substring search plugin binding
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

# Autosuggestions + Substring search config
ZSH_AUTOSUGGEST_CLEAR_WIDGETS=("${(@)ZSH_AUTOSUGGEST_CLEAR_WIDGETS:#(up|down)-line-or-history}")
ZSH_AUTOSUGGEST_CLEAR_WIDGETS+=(history-substring-search-up history-substring-search-down)

# =====================================================================================================================
# Additional aliases
# =====================================================================================================================

# ------------------------------------------
# Applications
# ------------------------------------------
alias d='docker'
alias v='nvim'
alias g='git'
alias gbd='g push origin --delete $(git_current_branch)'
alias gcleanup=$'git fetch -p && git branch -v | grep \'gone\' | awk \'{print $1}\' | xargs -n 1 git branch -D'
alias dockerstopall='docker stop $(docker ps -a -q)'
alias dockerrmall='docker rm $(docker ps -a -q)'

# ------------------------------------------
# Other
# ------------------------------------------
alias q='exit'
alias topdu='du -a | sort -nr | head -50'
alias fsize='du -s'

# =====================================================================================================================
# Exports
# =====================================================================================================================
# Preferred editor for local and remote sessions
if [[ -n $SSH_CONNECTION ]]; then
  export EDITOR='vim'
else
  export EDITOR='nvim'
fi

# Add bin folder to path
export PATH=$HOME/bin:$PATH

# Direnv integrationÂ¬
# eval "$(direnv hook zsh)"

# Iterm2 shell integrations
# test -e "{{ user.home }}/.iterm2_shell_integration.zsh" && source "{{ user.home }}/.iterm2_shell_integration.zsh"

# THIS MUST BE AT THE END OF THE FILE FOR SDKMAN TO WORK!!!
export SDKMAN_DIR="{{ user.home }}/.sdkman"
[[ -s "{{ user.home }}/.sdkman/bin/sdkman-init.sh" ]] && source "{{ user.home }}/.sdkman/bin/sdkman-init.sh"
